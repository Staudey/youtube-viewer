From c17bcd3c91168db3cb4ce88f394a646b1f88859f Mon Sep 17 00:00:00 2001
From: Joshua Strobl <joshua@streambits.io>
Date: Tue, 27 Oct 2020 21:55:32 +0200
Subject: [PATCH 1/1] Patch to reference youtube-dlc

---
 bin/gtk2-youtube-viewer  |  8 ++++----
 bin/gtk3-youtube-viewer  |  8 ++++----
 bin/youtube-viewer       | 20 ++++++++++----------
 lib/WWW/YoutubeViewer.pm | 14 +++++++-------
 4 files changed, 25 insertions(+), 25 deletions(-)

diff --git a/bin/gtk2-youtube-viewer b/bin/gtk2-youtube-viewer
index f2b15ad..30867d8 100755
--- a/bin/gtk2-youtube-viewer
+++ b/bin/gtk2-youtube-viewer
@@ -225,7 +225,7 @@ my %CONFIG = (
     fullscreen  => 0,
     audio_only  => 0,
 
-    # youtube-dl support
+    # youtube-dlc support
     ytdl     => 1,
     ytdl_cmd => undef,    # auto-detect
 
@@ -672,13 +672,13 @@ foreach my $path ($CONFIG{cache_dir}) {
     }
 }
 
-# Locate youtube-dl
+# Locate youtube-dlc
 if (not defined $CONFIG{ytdl_cmd}) {
-    if (defined(my $path = which_command('youtube-dl'))) {
+    if (defined(my $path = which_command('youtube-dlc'))) {
         $CONFIG{ytdl_cmd} = $path;
     }
     else {
-        $CONFIG{ytdl_cmd} = 'youtube-dl';
+        $CONFIG{ytdl_cmd} = 'youtube-dlc';
     }
 }
 
diff --git a/bin/gtk3-youtube-viewer b/bin/gtk3-youtube-viewer
index d408060..8803c5e 100755
--- a/bin/gtk3-youtube-viewer
+++ b/bin/gtk3-youtube-viewer
@@ -230,7 +230,7 @@ my %CONFIG = (
     fullscreen  => 0,
     audio_only  => 0,
 
-    # youtube-dl support
+    # youtube-dlc support
     ytdl     => 1,
     ytdl_cmd => undef,    # auto-detect
 
@@ -754,13 +754,13 @@ foreach my $path ($CONFIG{cache_dir}) {
     }
 }
 
-# Locate youtube-dl
+# Locate youtube-dlc
 if (not defined $CONFIG{ytdl_cmd}) {
-    if (defined(my $path = which_command('youtube-dl'))) {
+    if (defined(my $path = which_command('youtube-dlc'))) {
         $CONFIG{ytdl_cmd} = $path;
     }
     else {
-        $CONFIG{ytdl_cmd} = 'youtube-dl';
+        $CONFIG{ytdl_cmd} = 'youtube-dlc';
     }
 }
 
diff --git a/bin/youtube-viewer b/bin/youtube-viewer
index 10747dd..19fb6ee 100755
--- a/bin/youtube-viewer
+++ b/bin/youtube-viewer
@@ -266,7 +266,7 @@ my %CONFIG = (
     highlight_color   => 'bold',
     skip_watched      => 0,
 
-    # youtube-dl support
+    # youtube-dlc support
     ytdl     => 1,
     ytdl_cmd => undef,    # auto-defined
 
@@ -485,16 +485,16 @@ sub load_config {
         }
     }
 
-    # Locate youtube-dl
+    # Locate youtube-dlc
     if (not defined($CONFIG{ytdl_cmd})) {
 
-        my $ytdl_path = which_command('youtube-dl');
+        my $ytdl_path = which_command('youtube-dlc');
 
         if (defined($ytdl_path)) {
             $CONFIG{ytdl_cmd} = $ytdl_path;
         }
         else {
-            $CONFIG{ytdl_cmd} = 'youtube-dl';
+            $CONFIG{ytdl_cmd} = 'youtube-dlc';
         }
 
         $update_config = 1;
@@ -871,9 +871,9 @@ usage: $execname [options] ([url] | [keywords])
    --dash!              : include or exclude the DASH itags
    --dash-mp4a!         : include or exclude the itags for MP4 audio streams
    --dash-segmented!    : include or exclude segmented DASH streams
-   --ytdl!              : use youtube-dl for videos with encrypted signatures
+   --ytdl!              : use youtube-dlc for videos with encrypted signatures
                           `--no-ytdl` will use invidious instances
-   --ytdl-cmd=s         : youtube-dl command (default: youtube-dl)
+   --ytdl-cmd=s         : youtube-dlc command (default: youtube-dlc)
 
 Help options:
    -T  --tricks         : show more 'hidden' features of $execname
@@ -4601,11 +4601,11 @@ Format to convert each downloaded video into. (e.g.: C<"mp3">).
 
 Load cookies from a file. Useful to overcome the "429: Too Many Requests" issue.
 
-The file must be a C<# Netscape HTTP Cookie File>. Same format as C<youtube-dl> requires.
+The file must be a C<# Netscape HTTP Cookie File>. Same format as C<youtube-dlc> requires.
 
 See also:
 
-    https://github.com/ytdl-org/youtube-dl#how-do-i-pass-cookies-to-youtube-dl
+    https://github.com/ytdl-org/youtube-dlc#how-do-i-pass-cookies-to-youtube-dlc
 
 =head2 copy_caption
 
@@ -4986,13 +4986,13 @@ Format for C<sprintf()> for constructing an YouTube video URL given the video ID
 
 =head2 ytdl
 
-Use C<youtube-dl> for videos with encrypted signatures.
+Use C<youtube-dlc> for videos with encrypted signatures.
 
 When set to C<0>, invidious instances will be used instead.
 
 =head2 ytdl_cmd
 
-Command for C<youtube-dl> when C<ytdl> is set to a true value.
+Command for C<youtube-dlc> when C<ytdl> is set to a true value.
 
 =head1 CONFIGURATION FILES
 
diff --git a/lib/WWW/YoutubeViewer.pm b/lib/WWW/YoutubeViewer.pm
index 7ff654e..f04f378 100644
--- a/lib/WWW/YoutubeViewer.pm
+++ b/lib/WWW/YoutubeViewer.pm
@@ -86,9 +86,9 @@ my %valid_options = (
     cache_dir   => {valid => qr/^./,     default => q{.}},
     cookie_file => {valid => qr/^./,     default => undef},
 
-    # Support for youtube-dl
+    # Support for youtube-dlc
     ytdl     => {valid => [1, 0], default => 1},
-    ytdl_cmd => {valid => qr/\w/, default => "youtube-dl"},
+    ytdl_cmd => {valid => qr/\w/, default => "youtube-dlc"},
 
     # Booleans
     env_proxy   => {valid => [1, 0], default => 1},
@@ -315,7 +315,7 @@ sub set_lwp_useragent {
         #   https://addons.mozilla.org/en-US/firefox/addon/cookies-txt/
 
         # See also:
-        #   https://github.com/ytdl-org/youtube-dl#how-do-i-pass-cookies-to-youtube-dl
+        #   https://github.com/ytdl-org/youtube-dlc#how-do-i-pass-cookies-to-youtube-dlc
 
         require HTTP::Cookies::Netscape;
 
@@ -700,18 +700,18 @@ sub _fallback_extract_urls {
 
     my @formats;
 
-    # Use youtube-dl
+    # Use youtube-dlc
     if ($self->get_ytdl and $self->_ytdl_is_available) {
 
         if ($self->get_debug) {
-            say STDERR ":: Using youtube-dl to extract the streaming URLs...";
+            say STDERR ":: Using youtube-dlc to extract the streaming URLs...";
         }
 
         push @formats, $self->_extract_from_ytdl($videoID);
 
         if ($self->get_debug) {
             my $count = scalar(@formats);
-            say STDERR ":: youtube-dl: found $count streaming URLs...";
+            say STDERR ":: youtube-dlc: found $count streaming URLs...";
         }
 
         @formats && return @formats;
@@ -989,7 +989,7 @@ sub get_streaming_urls {
         say STDERR ":: Found $count streaming URLs...";
     }
 
-    # Try again with youtube-dl
+    # Try again with youtube-dlc
     if (!@streaming_urls or $info{status} =~ /fail|error/i) {
         @streaming_urls = $self->_fallback_extract_urls($videoID);
     }
-- 
2.29.1

